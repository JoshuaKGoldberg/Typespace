#! /usr/bin/env node
/// <reference path="../typings/node/index.d.ts" />

var commander = require("commander");
var fs = require("fs");
var package = require("../package.json");
var Typespace = require("../lib/Typespace").Typespace;

commander
    .description(package.description)
    .version(package.version)
    .usage("[-d directory] [-f file.ts, ...] [-o output.ts] [-p tsconfig.json] [-r MyProject]")
    .option("-c --config [path]", "input tsconfig.json file path to load files from (optional)")
    .option("-d --directory [string]", "directory root to ignore from module paths")
    .option("-f --files [paths]", "paths of files to include (optional)")
    .option("-r --root [string]", "name of the output root namespace")
    .option("-o --outFile [path]", "output .ts file path (optional)")
    .parse(process.argv);

new Typespace(commander).convert()
    .then(contents => {
        if (commander.outFile) {
            fs.writeFileSync(commander.out, contents);
        }
    })
    .catch(error => console.error(error.stack));
